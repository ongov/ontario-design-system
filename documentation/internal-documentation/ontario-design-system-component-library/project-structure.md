# Ontario Design System Component Library Project Structure

For more information on the Ontario Design System and what it is, please refer to the [Ontario Design System website](https://designsystem.ontario.ca/).

This project follows a standard StencilJS component library setup, with a few additional scripts and folders specific to our build process.

```text
ontario-design-system-component-library/
├── .stencil/
├── dist/
├── scripts/
├── src/
│   ├── components/
│   │   ├── component-name/
│   │   │   ├── tests/
│   │   │   ├── component-name.tsx
│   │   │   ├── component-name.scss
│   │   │   └── ...other component related files (interfaces, etc.)
│   ├── styles/
│   │   ├── slotted-styles/
│   │   └── ...common-style SCSS files
│   ├── translations/
│   └── utils/
├── www/
├── stencil.config.ts
└── tsconfig.json
```

Below is an overview of the key folders and files in the project:

## _`.stencil`_

This folder is automatically generated by Stencil during the build process. It contains intermediate build artifacts and outputs that are necessary for the library’s internal operations but should not be manually edited.

## _`dist`_

The dist directory contains the final build output of the component library, including compiled JavaScript, CSS, and other assets. This folder is where the packaged components are prepared for distribution.

## `scripts`

This folder contains various scripts used to automate tasks in the project. Notable scripts include:

- A script to build out a `theme.scss` file that gets placed in the `dist` folder.
- A script to create a documentation bundle based on the component readme files.
- A configuration build script to manage build processes and any custom actions needed for our workflow.

## `src`

The `src` folder contains all the core code for the component library, including components, styles, utilities, and translations. Below is a detailed breakdown of the subfolders and their contents:

### `components`

This folder contains all the StencilJS components that make up the library. Each component is stored in its own directory and follows the pattern:

- **Component Directory**: Each component has its own subfolder containing:
  - **Component File (_component-name.tsx_)**: The main TypeScript file where the logic for the component is written.
  - **Style File (_component-name.scss_)**: The component-specific styles, written in SCSS. This file defines the appearance of the component and uses the [BEM methodology](https://en.bem.info/methodology/) for class naming, and variables from the global styles package for styling.
  - **Test folder**: Contains unit and e2e tests for the component, ensuring the component functions as expected in various scenarios.
  - **README File**: Each component contains a README.md file that describes the component's usage, features, and configuration options.

Note that this folder structure and the necessary files can be generated using Stencil's CLI command:

```bash
pnpm stencil generate component-name
```

Certain components also include interface and type files to keep the code cleaner and more readable.

### `styles`

The `styles` folder contains component-specific styles that are shared across multiple components, as well as slotted styles for content outside the component's Shadow DOM. Here's an overview of what's included in this folder:

#### Shared Component-Specific Styles

These styles are designed for individual components but shared across multiple instances of that component within the library.

The goal of including them here, rather than in the `ontario-design-system-global-styles` project, is to maintain better encapsulation. By keeping these styles within the component folder, it ensures that the styles are tightly scoped to their corresponding component and do not unintentionally affect other parts of the library or project.

This approach makes it easier to maintain, update, and troubleshoot styles that are specific to individual components, without having to deal with global styles that might be applied elsewhere.

#### Slotted Styles

Slotted content in StencilJS components presents a unique styling challenge. Because slotted elements are rendered outside the component’s Shadow DOM, styles scoped to the component cannot directly target them. Additionally, while the `::slotted` pseudo-element allows styling of direct children within slots, it does not support styling deeper descendants within the slotted content.

To handle this, we use a separate global stylesheet for slotted styles. This approach provides the following benefits:

1. **Automatic Styling for Slotted Content**: Slotted elements are styled automatically, without requiring consumers to add extra classes or external styles to the slotted elements.
2. **Centralized Styles**: By keeping all slotted styles in one place, we improve maintainability and organization. Consumers don't need to worry about styling slotted content manually, as it’s handled through the library.

There is a `global.scss` file at the root of the project that imports the core theme from the Ontario Design System Global Styles. To ensure that slotted content is styled properly, any additional slotted style files should be appended to this `global.scss` file. This allows for slotted styles to be applied correctly while maintaining proper order and precedence over the base global styles.

The slotted styles are stored in the `styles/slotted-styles` folder and processed by a build script that compiles them into a `theme.scss` file. This file is then included in the build output and made available to all component libraries.

The `build-theme-scss.ts` script does the following:

- It gathers all `.scss` files in the `styles/slotted-styles` folder.
- It generates a `theme.scss` file that imports and forwards the global styles (such as those from the Ontario Design System Global Styles).
- The generated `theme.scss` file is placed in the dist folder for use in the component library and output targets.
- The build script ensures that the styles are dynamically compiled, so developers don’t need to worry about manually updating the `theme.scss` file every time slotted styles change.

### `translations`

The `translations` folder contains the core translation file used across the components to support internationalization (i18n). The main translation file is structured in a JSON-like format, where text for each component or UI element is mapped to different language keys (e.g., English and French). Each entry has specific translations for each supported language, allowing the components to dynamically display text based on the user's language preference.

For example, the translation file may look like this:

```json
"accessibility": {
    "checkboxHintExpander": {
        "en": "is available after the last checkbox item.",
        "fr": "suivront à la dernière case à cocher."
    },
    "moreInfo": {
        "en": "More information on",
        "fr": "Des renseignements supplémentaires sur"
    },
    "singleHintExpander": {
        "en": "field is available in the next element.",
        "fr": "suivront au prochain élément."
    }
}
```

- Each section corresponds to a component or feature (e.g., accessibility), and within that section, each key represents a specific UI element or text string.
- The keys within each section (e.g., checkboxHintExpander, moreInfo, singleHintExpander) represent specific phrases or hints displayed in the UI.
- Each language code (e.g., en for English, fr for French) maps to the translated text for that particular language.

This setup ensures that text can be easily swapped based on the language preference, helping developers create multilingual support for their components.

### `utils`

The utils folder houses helper functions and shared code used across components. Examples include:

- **Validation Functions**: Functions to validate input values, component properties, or other data within components.
- **Shared Type Interfaces**: TypeScript interfaces that define common types used throughout the component library, ensuring consistency.
- **Console Messages**: Utility functions for generating warning or error messages displayed in the console, helping developers identify issues.
- **Common Outputs**: Functions for generating commonly used labels or strings that might be used in multiple components.

## _`www`_

This directory is generated by Stencil and contains the static website and documentation for the component library. It is typically used for live previews and development testing.

## `stencil.config.ts`

This is the configuration file for StencilJS, where the build process, component configurations, and other Stencil-related settings are defined.

More optional config properties can be found in the [StencilJS docs](https://stenciljs.com/docs/config).

## `tsconfig.json`

The TypeScript configuration file that defines compiler options and the paths for the TypeScript compiler to follow.
